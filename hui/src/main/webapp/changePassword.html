<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>注册页面</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
</head>
<body>
<div class="container">
    <div align="center"><h4>修改密码</h4></div>
    <form action="" method="post" name="f">
        <div class="form-group row">
            <label>旧密码:</label>
            <input type="password" class="form-control" name="oldpassword" id="oldpassword">
            <small id="sml" style="color: red"></small>
        </div>
        <div class="form-group row">
            <label>新密码:</label>
            <input type="password" class="form-control" name="newpassword" id="newpassword">
        </div>
        <div align="center">
            <button type="button" class="btn btn-primary" id="btnChange"> 确认</button>&nbsp;&nbsp;<button type="reset"
                                                                                                         class="btn btn-danger">
            重置
        </button>
        </div>
    </form>
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="static/h-ui/js/H-ui.min.js"></script>
    <script src="static/layer/2.4/layer.js"></script>
    <script>
        $(window).on("load", () => {
            $("#btnChange").click(() => {
                var oldpassword = localStorage.getItem("oldpassword")
                var userid = localStorage.getItem("userid")
                var newpwd = $("#newpassword").val()
                var oldpwd=$("#oldpassword").val()
                if(oldpassword==oldpwd) {
                    $.ajax({
                        type: "post",
                        url: "ModifyServlet",
                        data: {mid: userid, newpwd: newpwd},
                        dataType: "text",
                        success: function (data) {
                            layer.alert(data)
                        }
                    })
                }else {
                    layer.alert("旧密码不正确!")
                }
            })
        })
    </script>
</div>
</body>
</html>